# ============================================================
# 无人机租赁平台 - 后端配置文件模板
# ============================================================
# 使用说明：
# 1. 复制此文件为 config.yaml
# 2. 根据实际环境修改配置项
# 3. 生产环境必须修改所有标记为 [必须修改] 的配置项
# ============================================================

# ------------------------------------------------------------
# 服务器基础配置
# 重要性等级：中
# ------------------------------------------------------------
server:
  # 服务监听端口
  # 格式：1024-65535 的整数
  port: 8080
  
  # 运行模式
  # 可选值：debug（开发模式，详细日志）、release（生产模式）、test（测试模式）
  # 生产环境必须设置为 release
  mode: debug

# ------------------------------------------------------------
# MySQL 数据库配置
# 重要性等级：高 [必须修改]
# ------------------------------------------------------------
database:
  # 数据库服务器地址
  # 开发环境：127.0.0.1 或 localhost
  # 生产环境：填写实际数据库服务器IP或域名
  host: 127.0.0.1
  
  # 数据库端口（MySQL默认3306）
  port: 3306
  
  # 数据库用户名 [必须修改]
  # 生产环境请勿使用root账户
  user: your_db_user
  
  # 数据库密码 [必须修改]
  # 生产环境请使用强密码（至少16位，包含大小写字母、数字、特殊字符）
  password: your_db_password
  
  # 数据库名称
  # 需要预先创建该数据库：CREATE DATABASE wurenji CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
  dbname: wurenji
  
  # 字符集，建议使用utf8mb4以支持emoji
  charset: utf8mb4
  
  # 连接池配置
  # 空闲连接数（根据服务器内存调整）
  max_idle_conns: 10
  # 最大打开连接数（根据MySQL max_connections调整）
  max_open_conns: 100

# ------------------------------------------------------------
# Redis 缓存配置
# 重要性等级：高 [必须修改]
# 用途：验证码存储、会话缓存、限流等
# ------------------------------------------------------------
redis:
  # Redis服务器地址
  host: 127.0.0.1
  
  # Redis端口（默认6379）
  port: 6379
  
  # Redis密码 [生产环境必须修改]
  # 留空表示无密码（仅限开发环境）
  password: ""
  
  # 数据库编号（0-15）
  # 建议不同环境使用不同db编号
  db: 0

# ------------------------------------------------------------
# JWT 认证配置
# 重要性等级：高 [必须修改]
# ------------------------------------------------------------
jwt:
  # JWT签名密钥 [必须修改]
  # 要求：至少32位随机字符串
  # 生成方法：openssl rand -base64 32
  # 警告：生产环境必须更换此密钥，泄露会导致安全问题
  secret: your-jwt-secret-key-at-least-32-characters-long
  
  # Access Token过期时间（秒）
  # 建议：7200（2小时）至 86400（24小时）
  access_expire: 7200
  
  # Refresh Token过期时间（秒）
  # 建议：604800（7天）至 2592000（30天）
  refresh_expire: 604800

# ------------------------------------------------------------
# 文件上传配置
# 重要性等级：中
# ------------------------------------------------------------
upload:
  # 单文件最大大小（MB）
  max_size: 5
  
  # 文件存储路径
  # 开发环境：./uploads
  # 生产环境：建议使用绝对路径或云存储
  save_path: ./uploads
  
  # 允许的文件扩展名
  allowed_exts:
    - .jpg
    - .jpeg
    - .png
    - .gif
    - .pdf

# ------------------------------------------------------------
# 短信服务配置
# 重要性等级：高 [生产环境必须修改]
# ------------------------------------------------------------
sms:
  # 短信服务提供商
  # 可选值：mock（开发测试用）、aliyun（阿里云短信）、tencent（腾讯云短信）
  # 开发环境使用mock，验证码会打印到控制台
  provider: mock
  
  # 短信签名名称
  # 阿里云/腾讯云后台申请的签名
  sign_name: "无人机平台"
  
  # 短信模板ID
  # 阿里云/腾讯云后台申请的模板代码
  template_code: "SMS_000000"
  
  # ========== 阿里云短信配置 ==========
  # 当 provider 为 aliyun 时需要配置以下参数
  aliyun:
    # AccessKey ID [必须修改]
    # 获取方式：阿里云控制台 -> AccessKey管理
    access_key_id: ""
    
    # AccessKey Secret [必须修改]
    # 注意：请妥善保管，泄露会导致安全问题
    access_key_secret: ""
    
    # 区域ID
    region_id: "cn-hangzhou"
  
  # ========== 腾讯云短信配置 ==========
  # 当 provider 为 tencent 时需要配置以下参数
  tencent:
    # SecretId [必须修改]
    secret_id: ""
    
    # SecretKey [必须修改]
    secret_key: ""
    
    # SDK AppID
    sdk_app_id: ""

# ------------------------------------------------------------
# 支付配置
# 重要性等级：高 [生产环境必须修改]
# ------------------------------------------------------------
payment:
  # 平台佣金比例（百分比）
  # 例如：10 表示平台收取10%佣金
  commission_rate: 10
  
  # ========== 微信支付配置 ==========
  wechat:
    # 微信开放平台应用ID [必须修改]
    # 获取方式：微信开放平台 -> 管理中心 -> 移动应用
    app_id: ""
    
    # 微信支付商户号 [必须修改]
    # 获取方式：微信商户平台 -> 账户中心 -> 商户信息
    mch_id: ""
    
    # 微信支付API密钥（APIv2） [必须修改]
    # 设置方式：微信商户平台 -> 账户中心 -> API安全 -> API密钥
    api_key: ""
    
    # 微信支付API证书路径（APIv3需要）
    cert_path: ""
    key_path: ""
    
    # 支付结果回调地址
    # 格式：https://your-domain.com/api/v1/payment/wechat/callback
    notify_url: ""
  
  # ========== 支付宝配置 ==========
  alipay:
    # 支付宝应用ID [必须修改]
    # 获取方式：支付宝开放平台 -> 开发者中心 -> 应用管理
    app_id: ""
    
    # 应用私钥（RSA2） [必须修改]
    # 使用支付宝密钥生成工具生成
    # 注意：可以填写私钥内容或私钥文件路径
    private_key: ""
    
    # 支付宝公钥 [必须修改]
    # 在支付宝开放平台配置应用公钥后获取
    public_key: ""
    
    # 是否使用沙箱环境
    # 开发测试时设为true
    sandbox: false
    
    # 支付结果回调地址
    notify_url: ""

# ------------------------------------------------------------
# 高德地图服务配置
# 重要性等级：中 [启用地图功能时必须修改]
# 用途：地理编码、路径规划、位置搜索
# ------------------------------------------------------------
amap:
  # 高德开放平台 Web服务 API Key [必须修改]
  # 获取方式：高德开放平台 -> 应用管理 -> 创建应用 -> 添加Key（选择Web服务）
  api_key: ""
  
  # 高德开放平台 Web端(JS API) Key
  # 用于Web管理后台的地图展示
  web_key: ""

# ------------------------------------------------------------
# WebSocket 配置
# 重要性等级：低
# 用途：实时消息推送
# ------------------------------------------------------------
websocket:
  # 单条消息最大大小（字节）
  max_message_size: 4096
  
  # 写入超时（秒）
  write_wait: 10
  
  # Pong响应超时（秒）
  pong_wait: 60
  
  # Ping发送间隔（秒）
  # 必须小于pong_wait
  ping_period: 54

# ------------------------------------------------------------
# 日志配置（可选）
# 重要性等级：低
# ------------------------------------------------------------
log:
  # 日志级别：debug, info, warn, error
  level: info
  
  # 日志输出方式：console, file, both
  output: console
  
  # 日志文件路径（output为file或both时生效）
  file_path: ./logs/app.log
  
  # 单个日志文件最大大小（MB）
  max_size: 100
  
  # 日志文件保留天数
  max_age: 30
  
  # 最多保留的日志文件数量
  max_backups: 10

# ------------------------------------------------------------
# CORS 跨域配置（可选）
# 重要性等级：中
# ------------------------------------------------------------
cors:
  # 允许的域名列表
  # 生产环境请配置具体域名，不要使用 *
  allowed_origins:
    - "http://localhost:3000"
    - "http://localhost:3100"
  
  # 允许的HTTP方法
  allowed_methods:
    - "GET"
    - "POST"
    - "PUT"
    - "DELETE"
    - "OPTIONS"
  
  # 允许的请求头
  allowed_headers:
    - "Authorization"
    - "Content-Type"
